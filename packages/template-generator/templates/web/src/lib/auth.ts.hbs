'use client'

import { useConvexAuth, useMutation, useQuery } from 'convex/react'
import { useAuthActions } from '@convex-dev/auth/react'
import { api } from '{{#if (eq structure 'monorepo')}}@repo/backend{{else}}../../convex/_generated/api{{/if}}'

export function useAuth() {
  const { isAuthenticated, isLoading } = useConvexAuth()
  const { signIn, signOut } = useAuthActions()
  const user = useQuery(api.users.current)

  return {
    isAuthenticated,
    isLoading,
    user,
    signIn: (provider: 'github' | 'google') => {
      void signIn(provider)
    },
    signOut: () => {
      void signOut()
    },
  }
}
